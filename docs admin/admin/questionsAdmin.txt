Moutassim Kho, [7/31/2025 6:15 PM]
# Unified Question System API Documentation

## New API Endpoints

### 1. Create Single Question
POST /api/v1/admin/questions

Creates a single question with unified metadata including examYear.

Headers:
Authorization: Bearer {admin_token}
Content-Type: application/json

Request Body:
{
  "questionText": "What is the primary function of the heart?",
  "explanation": "The heart pumps blood throughout the body",
  "questionType": "SINGLE_CHOICE",
  "courseId": 1,
  "universityId": 24,
  "yearLevel": "THREE",
  "examYear": 2024,
  "answers": [
    {
      "answerText": "Pumping blood",
      "isCorrect": true,
      "explanation": "Correct answer"
    },
    {
      "answerText": "Filtering toxins",
      "isCorrect": false,
      "explanation": "This is the function of kidneys"
    }
  ]
}

Response:
{
  "success": true,
  "data": {
    "question": {
      "id": 28,
      "questionText": "What is the primary function of the heart?",
      "questionType": "SINGLE_CHOICE",
      "courseId": 1,
      "universityId": 24,
      "yearLevel": "THREE",
      "examYear": 2024
    }
  }
}

### 2. Create Multiple Questions (Bulk)
POST /api/v1/admin/questions/bulk

Creates multiple questions with shared metadata.

Request Body:
{
  "metadata": {
    "courseId": 1,
    "universityId": 24,
    "yearLevel": "THREE",
    "examYear": 2024
  },
  "questions": [
    {
      "questionText": "Which organ filters blood?",
      "questionType": "SINGLE_CHOICE",
      "answers": [
        { "answerText": "Kidney", "isCorrect": true },
        { "answerText": "Liver", "isCorrect": false }
      ]
    },
    {
      "questionText": "Symptoms of hypertension include:",
      "questionType": "MULTIPLE_CHOICE",
      "answers": [
        { "answerText": "Headache", "isCorrect": true },
        { "answerText": "Dizziness", "isCorrect": true },
        { "answerText": "Fever", "isCorrect": false }
      ]
    }
  ]
}

Response:
{
  "success": true,
  "data": {
    "questions": [
      {
        "id": 29,
        "questionText": "Which organ filters blood?",
        "questionType": "SINGLE_CHOICE"
      },
      {
        "id": 30,
        "questionText": "Symptoms of hypertension include:",
        "questionType": "MULTIPLE_CHOICE"
      }
    ],
    "totalCreated": 2
  }
}

### 3. Get Question Filters
GET /api/v1/admin/questions/filters

Returns available filter options including examYears.

Response:
{
  "success": true,
  "data": {
    "filters": {
      "courses": [...],
      "universities": [...],
      "examYears": [2024, 2023, 2022],
      "questionTypes": ["SINGLE_CHOICE", "MULTIPLE_CHOICE"]
    }
  }
}

## Enhanced Quiz Session Creation

### Create Quiz Session with ExamYear Filter
POST /api/v1/quizzes/quiz-sessions

Now supports examYear filtering to select questions from specific exam years.

Request Body:
{
  "title": "Practice Session 2024",
  "type": "PRACTICE",
  "settings": {
    "questionCount": 10
  },
  "filters": {
    "examYears": [2024],
    "courseIds": [1, 2],
    "questionTypes": ["SINGLE_CHOICE"]
  }
}

Response:
{
  "success": true,
  "data": {
    "sessionId": 123
  }
}

## Question Types & Validation

### Single Choice Questions
- Must have exactly 1 correct answer
- Minimum 2 total answers required

### Multiple Choice Questions  
- Must have at least 2 correct answers
- Minimum 2 total answers required

## New Filter Options

| Filter | Type | Description | Example |
|--------|------|-------------|---------|
| examYears | number[] | Filter by exam year | [2024, 2023] |
| questionTypes | string[] | Filter by question type | ["SINGLE_CHOICE"] |
| courseIds | number[] | Filter by course | [1, 2, 3] |
| universityIds | number[] | Filter by university | [24] |
| yearLevels | string[] | Filter by academic year | ["THREE"] |

## Database Changes

### New Field: examYear
- Type: INTEGER
- Purpose: Year of the exam (e.g., 2024)
- Usage: Enables unified question filtering across quiz and exam sessions
- Example: 2024, 2023, 2022

Moutassim Kho, [7/31/2025 6:15 PM]
Questions now support both quiz and exam sessions through the unified question pool with enhanced metadata.

Moutassim Kho, [7/31/2025 6:16 PM]
# Question Field Explanations - Nullable Fields

## Optional/Nullable Fields in Question Creation

### Core Question Fields
{
  "questionText": "Required - The actual question text",
  "explanation": "Optional - Additional explanation for the question",
  "questionType": "Optional - Defaults to SINGLE_CHOICE if not provided"
}

### Metadata Fields (All Optional)
{
  "courseId": null,        // Optional - Link to specific course
  "examId": null,          // Optional - Link to specific exam  
  "universityId": null,    // Optional - Link to university
  "yearLevel": null,       // Optional - Academic year level
  "examYear": null         // Optional - Year of the exam (e.g., 2024)
}

## Why These Fields Are Nullable

### 1. courseId - Optional
// With course association
{
  "questionText": "Heart anatomy question",
  "courseId": 1  // Links to "Cardiac Physiology" course
}

// Without course association (general question)
{
  "questionText": "General medical knowledge",
  "courseId": null  // Not tied to specific course
}

### 2. examId - Optional
// Exam-specific question
{
  "questionText": "From 2024 final exam",
  "examId": 15  // Links to specific exam
}

// General practice question
{
  "questionText": "Practice question",
  "examId": null  // Not from specific exam
}

### 3. universityId - Optional
// University-specific question
{
  "questionText": "University of Algiers exam question",
  "universityId": 1
}

// Universal question
{
  "questionText": "Standard medical question",
  "universityId": null  // Applies to all universities
}

### 4. yearLevel - Optional
// Year-specific question
{
  "questionText": "Advanced cardiology for 5th year",
  "yearLevel": "FIVE"
}

// Multi-year question
{
  "questionText": "Basic anatomy for all years",
  "yearLevel": null
}

### 5. examYear - Optional
// Year-specific question
{
  "questionText": "From 2024 exam session",
  "examYear": 2024
}

// Timeless question
{
  "questionText": "General knowledge question",
  "examYear": null  // Not tied to specific year
}

## Practical Examples

### Minimal Question (Only Required Fields)
{
  "questionText": "What is the largest organ in the human body?",
  "answers": [
    { "answerText": "Skin", "isCorrect": true },
    { "answerText": "Liver", "isCorrect": false }
  ]
}

### Fully Specified Question
{
  "questionText": "Describe the cardiac cycle phases",
  "explanation": "Understanding cardiac physiology is crucial",
  "questionType": "MULTIPLE_CHOICE",
  "courseId": 3,
  "universityId": 1,
  "yearLevel": "FOUR",
  "examYear": 2024,
  "answers": [...]
}

### Bulk Creation with Shared Metadata
{
  "metadata": {
    "courseId": 1,
    "universityId": 1,
    "yearLevel": "THREE",
    "examYear": 2024
  },
  "questions": [
    {
      "questionText": "Question 1 - inherits all metadata",
      "answers": [...]
    },
    {
      "questionText": "Question 2 - also inherits metadata", 
      "answers": [...]
    }
  ]
}

## Benefits of Nullable Fields

1. Flexibility - Create questions at different specificity levels
2. Reusability - General questions can be used across multiple contexts
3. Gradual Enhancement - Start simple, add metadata later
4. Unified Pool - All questions available for both quiz and exam sessions
5. Smart Filtering - Filter by any combination of available metadata

This design allows the system to handle everything from general practice questions to highly specific exam questions within the same unified structure.